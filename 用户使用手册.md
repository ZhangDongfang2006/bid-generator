# 投标文件自动生成系统 - 使用手册

> 海越（湖北）电气股份有限公司内部使用系统

## 目录

- [系统要求](#系统要求)
- [安装指南](#安装指南)
- [启动系统](#启动系统)
- [使用教程](#使用教程)
- [局域网访问](#局域网访问)
- [数据管理](#数据管理)
- [常见问题](#常见问题)

---

## 系统要求

### 必需环境
- **操作系统**：Windows 10/11、macOS、Linux
- **Python 版本**：3.8 或更高版本
- **浏览器**：Chrome、Edge、Firefox（推荐使用 Chrome）

### 推荐配置
- **内存**：4GB 及以上
- **硬盘**：至少 1GB 可用空间
- **网络**：稳定的互联网连接（用于下载依赖包）

---

## 安装指南

### 步骤1：获取项目文件

从项目负责人处获取项目文件包，解压到本地目录，例如：
- Windows: `C:\bid-generator\`
- macOS/Linux: `~/workspace/bid-generator/`

### 步骤2：检查 Python 环境

打开终端/命令提示符，输入：

```bash
python3 --version
```

如果显示版本号（如 Python 3.9.0 或更高），说明已安装。

如果提示找不到 python3，请先安装 Python：
- Windows: 访问 https://www.python.org/downloads/ 下载安装
- macOS: `brew install python3`
- Linux: `sudo apt install python3`

### 步骤3：进入项目目录

```bash
cd ~/workspace/bid-generator
# Windows 用户：
# cd C:\bid-generator
```

### 步骤4：安装依赖包

```bash
# 方法1：使用快速启动脚本（推荐）
./setup.sh
# Windows 用户请使用 Git Bash 或 WSL

# 方法2：手动安装
pip3 install -r requirements.txt
```

安装过程可能需要 5-10 分钟，请耐心等待。

### 步骤5：初始化数据库

```bash
python3 database.py
```

---

## 启动系统

### 本地启动（单机使用）

```bash
streamlit run app.py
```

启动后，浏览器会自动打开：`http://localhost:8501`

如果浏览器未自动打开，请手动在浏览器中访问上述地址。

### 指定端口启动

如果 8501 端口被占用，可以指定其他端口：

```bash
streamlit run app.py --server.port 8502
```

---

## 使用教程

### 界面概览

系统主界面分为三个部分：
- **左侧菜单**：功能导航
- **中央区域**：主要操作区
- **右侧面板**：辅助信息和帮助

### 功能1：生成投标文件

#### 步骤1：上传招标文件
1. 点击左侧菜单的 **"📄 生成投标文件"**
2. 点击 **"📤 上传招标文件"** 按钮
3. 选择招标文件（支持 PDF 或 Word 格式）
4. 等待文件上传完成

#### 步骤2：解析招标文件
1. 点击 **"🔍 解析文件"** 按钮
2. 系统会自动解析文件内容
3. 查看解析结果，确保信息提取正确

#### 步骤3：匹配公司资料
1. 点击 **"🔗 匹配资料"** 按钮
2. 系统会自动匹配相关的：
   - 资质证书
   - 项目案例
   - 产品信息
   - 人员信息
3. 根据需要调整匹配结果

#### 步骤4：生成投标文件
1. 点击 **"🚀 生成投标文件"** 按钮
2. 选择要生成的章节：
   - 公司简介
   - 技术方案
   - 商务报价
   - 资质证明
   - 业绩案例
   - 售后服务
   - 承诺声明
3. 等待生成完成
4. 点击 **"📥 下载投标文件"** 保存到本地

### 功能2：资料管理

#### 添加公司资质
1. 点击左侧菜单的 **"📊 资料管理"**
2. 选择 **"📜 公司资质"** 标签
3. 填写资质信息：
   - 资质名称
   - 资质等级
   - 证书编号
   - 有效期至
4. 点击 **"添加资质"** 保存

#### 添加项目案例
1. 选择 **"📁 项目案例"** 标签
2. 填写案例信息：
   - 项目名称
   - 客户单位
   - 所属行业
   - 产品类型
   - 合同金额
   - 项目年份
   - 项目描述
3. 点击 **"添加案例"** 保存

#### 添加产品信息
1. 选择 **"📦 产品信息"** 标签
2. 填写产品信息：
   - 产品名称
   - 产品型号
   - 产品类别
   - 产品描述
   - 参考价格
3. 点击 **"添加产品"** 保存

#### 添加人员信息
1. 选择 **"👥 人员信息"** 标签
2. 填写人员信息：
   - 姓名
   - 职位
   - 职称
   - 工作年限
   - 证书列表
   - 个人简介
3. 选择人员类别（管理层/工程师/生产人员）
4. 点击 **"添加人员"** 保存

### 功能3：查看和编辑资料

在资料管理界面中：
- 点击每条记录右侧的 **"✏️ 编辑"** 按钮可以修改
- 点击 **"🗑️ 删除"** 按钮可以删除
- 支持按关键词搜索

---

## 局域网访问

### 允许局域网访问（多人共用）

如果需要让同一局域网内的其他同事访问系统，需要修改启动命令：

```bash
streamlit run app.py --server.address=0.0.0.0
```

启动后，其他同事可以通过以下方式访问：
- 你的 IP 地址:8501
- 例如：`http://192.168.1.100:8501`

### 查看本机 IP 地址

**Windows:**
```bash
ipconfig
```
找到 "IPv4 地址" 一栏的值。

**macOS/Linux:**
```bash
ifconfig | grep "inet "
```
找到类似 `192.168.1.x` 的地址。

### 防火墙设置

确保防火墙允许 8501 端口的访问：

**Windows:**
1. 打开"Windows Defender 防火墙"
2. 点击"高级设置"
3. 选择"入站规则" → "新建规则"
4. 选择"端口" → "TCP" → 特定本地端口：8501
5. 选择"允许连接"
6. 完成

**macOS:**
```bash
# 系统偏好设置 → 安全性与隐私 → 防火墙 → 防火墙选项
# 添加 Python 或允许入站连接
```

**Linux (Ubuntu):**
```bash
sudo ufw allow 8501/tcp
```

---

## 数据管理

### 数据存储位置

所有数据存储在项目目录下的 `data/` 文件夹中：
- `qualifications.json` - 资质证书
- `cases.json` - 项目案例
- `products.json` - 产品信息
- `personnel.json` - 人员信息

### 备份数据

定期备份数据非常重要，建议每周备份一次：

**macOS/Linux:**
```bash
# 创建带日期的备份
cp -r data data_backup_$(date +%Y%m%d)

# 或备份到指定位置
cp -r data ~/Documents/bid_generator_backup/
```

**Windows:**
```cmd
REM 创建备份文件夹
xcopy data data_backup_%date:~0,4%%date:~5,2%%date:~8,2% /E /I
```

### 恢复数据

如果需要恢复之前的备份数据：

**macOS/Linux:**
```bash
# 删除当前数据
rm -rf data/*

# 恢复备份
cp -r data_backup_20240211/* data/
```

**Windows:**
```cmd
REM 删除当前数据
del data\*.*

REM 恢复备份
xcopy data_backup_20240211\* data\ /E /I
```

### 分享数据

如果需要和同事共享数据：

1. **方式1：共享文件夹**
   - 将 `data/` 文件夹放在共享目录
   - 其他同事复制到自己的项目目录

2. **方式2：云盘共享**
   - 上传 `data/` 文件夹到云盘（如百度网盘、腾讯文档）
   - 其他同事下载并替换

3. **方式3：Git 版本控制**
   - 初始化 Git 仓库
   - 提交数据变更
   - 其他同事拉取更新

### 导出数据

可以将数据导出为 Excel 格式方便编辑：

```bash
python3 -c "
import pandas as pd
import json
from pathlib import Path

data_dir = Path('data')

# 导出资质
with open(data_dir / 'qualifications.json', 'r', encoding='utf-8') as f:
    qual = json.load(f)
    pd.DataFrame(qual['qualifications']).to_excel('qualifications.xlsx', index=False)

# 导出案例
with open(data_dir / 'cases.json', 'r', encoding='utf-8') as f:
    cases = json.load(f)
    pd.DataFrame(cases['cases']).to_excel('cases.xlsx', index=False)

print('导出完成！')
"
```

---

## 常见问题

### Q1: 安装依赖时提示权限错误

**A:** 使用 `--user` 参数安装：
```bash
pip3 install --user -r requirements.txt
```

### Q2: 启动时提示端口被占用

**A:** 更换端口：
```bash
streamlit run app.py --server.port 8502
```

### Q3: 其他电脑无法访问

**A:** 检查以下几点：
1. 确认使用 `--server.address=0.0.0.0` 启动
2. 检查防火墙设置
3. 确认两台电脑在同一局域网
4. 确认 IP 地址正确
5. 尝试关闭 VPN

### Q4: 生成的投标文件格式不对

**A:**
1. 检查招标文件是否是清晰的 PDF/Word
2. 尝试手动编辑解析结果
3. 检查资料是否完整（资质、案例、产品等）
4. 下载后用 Word 打开进一步编辑

### Q5: 如何添加自定义模板

**A:**
1. 准备 Word 格式的模板文件
2. 放入 `templates/` 目录
3. 修改 `generator.py` 中的模板引用
4. 重启系统

### Q6: 系统占用内存太大

**A:**
1. 关闭不必要的浏览器标签
2. 重启系统
3. 清理浏览器缓存
4. 如果持续出现问题，请联系技术支持

### Q7: 生成的文件在哪里？

**A:**
- 自动保存在 `output/` 目录下
- 也可以在界面中直接下载

### Q8: 如何清空所有数据？

**A:**
```bash
# 备份数据（重要！）
cp -r data data_backup_before_clear

# 清空数据
python3 database.py  # 会重新初始化
```

---

## 技术支持

### 联系方式
- **技术支持邮箱**：gl@haiyueelec.com
- **支持电话**：0712-8303989
- **工作时间**：周一至周五 9:00-18:00

### 反馈问题
遇到问题时，请提供以下信息：
1. 使用的操作系统和版本
2. Python 版本
3. 错误信息截图
4. 操作步骤描述
5. 招标文件（如涉及保密，请脱敏）

---

## 更新日志

### v2.0 (2026-02-12)
- 添加海越湖北电气完整资料
- 更新资质证书（11项）
- 更新产品信息（15项）
- 更新业绩案例（20项）
- 优化界面布局
- 添加局域网访问支持

### v1.0 (2026-02-11)
- 初始版本发布
- 基础投标文件生成功能
- 资料管理系统
- 招标文件解析功能

---

**祝使用愉快！**
